<% unless @issue.leaf? %>
  <div id="subtasks-export">
    <% other_formats_links do |f| %>
      <%= f.link_to 'CSV', :url => {}, :onclick => "showModal('csv-subtasks-export-options', '350px'); return false;" %>
      <%= f.link_to 'XLSX', :url => {}, :onclick => "showModal('xlsx-subtasks-export-options', '350px'); return false;" %>
      <%= f.link_to 'PDF', :url => {controller: 'subtask_export', action: 'subtasks', format: 'pdf'} %>
    <% end %>
  </div>

  <div id="csv-subtasks-export-options" style="display:none;">
    <h3 class="title"><%= l(:label_export_options, :export_format => 'CSV') %></h3>
    <%= form_tag issue_subtasks_export_path(format: 'csv'), :method => :get, :id => 'csv-subtasks-export-form' do %>
    <p>
      <label><%= check_box_tag 'description', '1'%> <%= l(:field_description) %></label>
      <label><%= check_box_tag 'comments', '1' %> <%= l(:field_comments) %></label>
    </p>
    <p class="buttons">
      <%= submit_tag l(:button_export), :name => nil, :onclick => "hideModal(this);" %>
      <%= submit_tag l(:button_cancel), :name => nil, :onclick => "hideModal(this);", :type => 'button' %>
    </p>
    <% end %>
  </div>

  <div id="xlsx-subtasks-export-options" style="display:none;">
    <h3 class="title"><%= l(:label_export_options, :export_format => 'XLSX') %></h3>
    <%= form_tag issue_subtasks_export_path(format: 'xlsx'), :method => :get, :id => 'xlsx-subtasks-export-form' do %>
    <p>
      <label><%= check_box_tag 'description', '1'%> <%= l(:field_description) %></label>
      <label><%= check_box_tag 'comments', '1' %> <%= l(:field_comments) %></label>
    </p>
    <p class="buttons">
      <%= submit_tag l(:button_export), :name => nil, :onclick => "hideModal(this);" %>
      <%= submit_tag l(:button_cancel), :name => nil, :onclick => "hideModal(this);", :type => 'button' %>
    </p>
    <% end %>
  </div>
<% end %>


<% if @relations.present? %>
  <div id="related-export">
    <% other_formats_links do |f| %>
      <%= f.link_to 'CSV', :url => {}, :onclick => "showModal('csv-related-export-options', '350px'); return false;" %>
      <%= f.link_to 'XLSX', :url => {}, :onclick => "showModal('xlsx-related-export-options', '350px'); return false;" %>
      <%= f.link_to 'PDF', :url => {controller: 'subtask_export', action: 'related', format: 'pdf'} %>
    <% end %>
  </div>

  <div id="csv-related-export-options" style="display:none;">
    <h3 class="title"><%= l(:label_export_options, :export_format => 'CSV') %></h3>
    <%= form_tag issue_related_export_path(format: 'csv'), :method => :get, :id => 'csv-related-export-form' do %>
    <p>
      <label><%= check_box_tag 'description', '1'%> <%= l(:field_description) %></label>
      <label><%= check_box_tag 'comments', '1' %> <%= l(:field_comments) %></label>
    </p>
    <p class="buttons">
      <%= submit_tag l(:button_export), :name => nil, :onclick => "hideModal(this);" %>
      <%= submit_tag l(:button_cancel), :name => nil, :onclick => "hideModal(this);", :type => 'button' %>
    </p>
    <% end %>
  </div>

  <div id="xlsx-related-export-options" style="display:none;">
    <h3 class="title"><%= l(:label_export_options, :export_format => 'XLSX') %></h3>
    <%= form_tag issue_related_export_path(format: 'xlsx'), :method => :get, :id => 'xlsx-related-export-form' do %>
    <p>
      <label><%= check_box_tag 'description', '1'%> <%= l(:field_description) %></label>
      <label><%= check_box_tag 'comments', '1' %> <%= l(:field_comments) %></label>
    </p>
    <p class="buttons">
      <%= submit_tag l(:button_export), :name => nil, :onclick => "hideModal(this);" %>
      <%= submit_tag l(:button_cancel), :name => nil, :onclick => "hideModal(this);", :type => 'button' %>
    </p>
    <% end %>
  </div>
<% end %>

<% content_for :header_tags do %>
  <%= javascript_include_tag 'issues_export.js', :plugin => 'redmine_export_subtasks' %>
  <%= stylesheet_link_tag 'issues_export.css', :plugin => 'redmine_export_subtasks' %>
<% end %>
